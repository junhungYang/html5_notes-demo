<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>history</title>
</head>

<body>
    <a href="./index.html">123</a>
    <script>
        //history 为一个历史记录存储栈，可以把访问过的页面的url存储于该栈中，先存进去的后出来
        //访问记录  默认页面 --> baidu -->淘宝，那么historyJ就存储了三个页面的url

        // 1、history.back() 后退一页
        // 2、 history.forward()  前进一页
        // 3、 history.go(n) n回到1指定的页

        //pushState 添加一条历史记录    
        // history.pushState(state, title, url); 

        //replaceState 替换当前的历史记录
        //history.replaceState(state, title, url); 

        //state：一个与指定网址相关的状态对象，popstate事件触发时，该对象会传入回调函数中。如果不需要这个对象，此处可以填null。
        //title：新页面的标题，但是所有浏览器目前都忽略这个值，因此这里可以填null
        //url：新的网址，必须与当前页面处在同一个域。浏览器的地址栏将显示这个网址。

        //详解
        //1. pushState是把要push的url,push至这个文档的url后 ==> [当前url,push进来的url],而浏览器会选择最后一个url作为最初要展示的文档的url
        //   repalceState是把当前的url替换为要替换当前url的url
        //2. 通过pushState或replaceState添加的历史记录，在前进或回退时都不会刷新页面，也不会发送ajax请求，所以页面内容还是一样

        history.pushState(null, null, './demo.html')

        //事件
        //1、popstate 事件
        // 历史记录发生改变时触发,只会在手动按前进后退按钮时，才会触发，调用pushState或者replaceState()不会触发该事件

        //解决前进和后退时页面不刷新的问题
        //前进和后退之所以页面不刷新的原因在于，页面内容还是一贯的页面内容，
        //而之所以会这样在于，前进和后退并不会发生ajax请求，不会法伤ajax请求的话页面便没有必要刷新
        //所以说解决这个问题的关键在于结合popstate事件监听前进和后退，当前进或后退时触发该事件发送ajax请求
        //可参考historyDemo.html


        //结论
        //关于人为push一条历史记录的情况，它只是有必要用于单页面的内容切换，因为除通过a标签或输入另一域名等一系列正常的网页切换外
        //网页内容的切换是不会产生历史记录的(例如点击了这个按钮后是这样的内容，点击了另一按钮后展示另一内容的情况)，
        //而且这个'有必要'也不是绝对的有必要，假如我就不想网页内容切换后，可以通过浏览器的前进与回退键回退回原来的内容的话，
        //那压根就没必要这样做，当然为了提高一点用户体验度这样做会更好一点，它能给用户当前这个网页跟前一个网页不是同一个网页的假象
        //它的初衷只是为了迎合使用者的一些倾向行为，当页面的内容发送大幅度变动时以为进入了另一个页面，所以希望从新回到前一个页面时
        //潜意识地去按浏览器的回退键，但客观事实是即使用户按了回退键，但页面还是那个页面，只是内容变了而已

        //首先pushState与replaceState是受同源策略限制的，其次它不会刷新页面，那么我们便务必要去进行类似'./index.html'的引入
        //传一个新的页面也没啥鸟用但，其次即使你传了另一文件的文件名也并不是引进了另外一个页面，还是那句话它不会刷新页面
        //只不过是创建了一条历史记录，而该历史记录的名字叫/.../.../index.html而已，何为历史记录中的记录，就是说它只是一条字符串记录，
        //除了这个以为没有其他意义

        //既然这两个方法不会刷新页面，那么就在原来的url上传一个特别的后缀标识就可以了( history.pushState(null,null,'?80')),
        //然后绑定popstate事件当产生前进或后退动作时匹配该标识发送相应的ajax请求即可
        //-------------------------------------------------------------------------------------------------------------------------
        //spa单页面应用
        //单页面与多页面各自的优点
        //当信息量巨大时(例如淘宝)，那么应用多页面的话在性能,和分类上会更趋优化
        //当信息量不大的话，或者类容重合度高(如每一个板块的头部分)应用单页面可以免去一些不必要的网络请求
    </script>
</body>

</html>